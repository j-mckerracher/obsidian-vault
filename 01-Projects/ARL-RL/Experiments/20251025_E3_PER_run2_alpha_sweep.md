---
project: ARL RL
tags: [project/arl-rl, stage-e3, per, sweep]
created: 2025-10-25
---

# E3 PER run-2 — Alpha Sweep (α=0.4, 0.5)

## Overview
- Run ID: run-2 (PER alpha sweep)
- Objective: Find stable PER alpha with α ∈ {0.4, 0.5}, β 0.6→1.0
- Part: Stage E3 — PER parameter tuning

## Config deltas (from E2 frozen baseline)
- PER_ENABLED: true
- PER_ALPHA: 0.4 or 0.5 (swept)
- PER_BETA_START: 0.6 (adjusted from 0.4)
- PER_BETA_END: 1.0
- NUM_EPISODES: 300-500 (sweep runs)
- All E2 parameters locked:
  - LR: 5e-5
  - EPS_DECAY: 100000
  - BATCH_SIZE: 4
  - REPLAY_MEMORY_SIZE: 100000
  - STEP_MUL: 16
  - SCREEN_RESOLUTION: 32
  - TARGET_UPDATE_FREQ: 400
  - DUELING_DQN: enabled

## Metadata
- Date/Time (UTC): 2025-10-25
- Git commit: (not tracked)
- Branch: main
- Seed(s): 4, 6, 8
- Environment: Gilbreth HPC
- SLURM: account=sbagchi, partition=a30, QoS=standby
- Resources: 1 GPU A30, 4 CPUs, 50GB RAM per job
- Command / Env overrides:
```bash
# Alpha 0.4
sbatch --account=sbagchi --partition=a30 --qos=standby --gres=gpu:1 \
  --ntasks=1 --cpus-per-task=4 --mem=50G --time=02:00:00 \
  --export=ALL,RL_SEED=<seed>,RL_NUM_EPISODES=500,RL_LEARNING_RATE=0.00005,\
RL_EPS_DECAY=100000,RL_BATCH_SIZE=4,RL_REPLAY_MEMORY_SIZE=100000,\
RL_SCREEN_RESOLUTION=32,RL_STEP_MUL=16,RL_TARGET_UPDATE_FREQ=400,\
RL_DUELING_DQN=1,RL_PER_ENABLED=1,RL_PER_ALPHA=0.4,RL_PER_BETA_START=0.6,\
RL_PER_BETA_END=1.0 \
  scripts/run_e3.sh

# Alpha 0.5
sbatch --account=sbagchi --partition=a30 --qos=standby --gres=gpu:1 \
  --ntasks=1 --cpus-per-task=4 --mem=50G --time=02:00:00 \
  --export=ALL,RL_SEED=<seed>,RL_NUM_EPISODES=500,RL_LEARNING_RATE=0.00005,\
RL_EPS_DECAY=100000,RL_BATCH_SIZE=4,RL_REPLAY_MEMORY_SIZE=100000,\
RL_SCREEN_RESOLUTION=32,RL_STEP_MUL=16,RL_TARGET_UPDATE_FREQ=400,\
RL_DUELING_DQN=1,RL_PER_ENABLED=1,RL_PER_ALPHA=0.5,RL_PER_BETA_START=0.6,\
RL_PER_BETA_END=1.0 \
  scripts/run_e3.sh
```
- Artifacts path: `/depot/sbagchi/data/josh/RL/FindAndDefeatZerglings/results_split_advanced/run-2/`

## Results
- Alpha 0.4 results (seeds 4, 6, 8):
  - Mean win rate: Below E2 baseline
  - Seed 8 still showing instability
- Alpha 0.5 results (seeds 4, 6, 8):
  - Mean win rate: Below E2 baseline
  - Variance still high, especially seed 8
- Aggregate across sweep:
  - No alpha value matched or exceeded E2 baseline (91.3%)
  - Seed 8 consistently unstable with PER enabled
  - Alpha reduction (0.6 → 0.5 → 0.4) did not resolve instability

## Observations
- Lower alpha values (0.4, 0.5) did not stabilize PER training
- Seed 8 remains problematic across all PER configurations tested
- PER may be fundamentally incompatible with current architecture/task
- E2 baseline (without PER) remains superior in both mean and variance
- Beta adjustment (0.6→1.0 vs 0.4→1.0) had minimal impact

## Next steps
- **Decision: Park PER** — does not improve over E2 baseline
- Proceed with E2 production runs: 2k-4k episodes per seed
- Document PER exploration and decision in Status/Plan
- Consider revisiting PER after resolution scaling or architecture changes
- Focus resources on E2 long-run validation and potential E4 (N-step returns)
