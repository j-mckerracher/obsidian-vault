---
project: ARL RL
tags: [project/arl-rl, work-log]
date: 2025-10-21
---

# Daily Work Log — 2025-10-21

## E1 aggregation (100-ep tests) and decision

### Summary
Aggregated 100-episode tests after +200-episode top-ups at 32×32 for seeds 4/6/8.

- Seed 4: 59.0%
- Seed 6: 0.0%
- Seed 8: 73.0%
- Mean: 44.0%; StdDev: 38.7 pp

### Decision
Per criteria (proceed to E2 unless mean < 40% or StdDev > 40 pp):
- Proceed to **Stage E2 (Dueling DQN)**.

### Notes
- High variance persists but below the >40 pp threshold; move forward while keeping runs short and parallel to respect queue limits.
- See per-run pages:
  - [[20251021_212042_E1_seed4]]
  - [[20251021_212805_E1_seed6]]
  - [[20251021_212805_E1_seed8]]

---

## Queue Stall Fix — Normal QoS Resubmission

### Summary
Canceled long-pending standby job chain (9774460–9774462) and resubmitted as independent normal QoS jobs on A30 partition for significantly faster start.

### Problem
- Standby chain (9774460→9774461→9774462) had been queued for 2+ days with no start.
- Low-priority backfill unlikely to get GPU time soon under cluster load.
- Time-sensitive experiments needed faster execution.

### Solution

#### Cancellation
```bash
scancel 9774460 9774461 9774462
```

#### Resubmission (independent, normal QoS)
```bash
for s in 4 6 8; do bash scripts/submit_e1_job.sh --account sbagchi --partition a30 --qos normal --time 04:00:00 --seeds "$s" --episodes 1000; done
```

### New Job IDs (Normal QoS, Independent Runs)
- Seed 4: **9795192** (1000 eps, 4h wall time)
- Seed 6: **9795193** (1000 eps, 4h wall time)
- Seed 8: **9795194** (1000 eps, 4h wall time)

### Configuration (Per Job)
- Partition: a30
- QoS: normal (higher priority, no dependency chain)
- Wall time: 04:00:00 (sufficient for ~1000 episodes at 32×32)
- Resources: ntasks=1, gpu=1, cpus-per-task=4, mem=50G
- Training: 1000 episodes per seed, Stage E1 recipe (Double DQN + LR scheduler)
- Resolution: 32×32

### Rationale
- **Independent runs**: Removes dependency chain overhead; each job can start as soon as GPU frees.
- **Normal QoS**: Higher priority than standby; typical wait time minutes–hours vs. days.
- **4h wall time**: Sufficient for 1k episodes; allows some headroom without bloating request.
- **Parallel potential**: If multiple A30 GPUs free, all three can run concurrently.

### Monitoring
```bash
squeue -j 9795192,9795193,9795194 -o "%18i %9P %32j %8T %10M %9l %6D %R"

# Per-job
squeue -j 9795192
squeue -j 9795193
squeue -j 9795194

# Watch completion
for j in 9795192 9795193 9795194; do 
  echo "Job $j:"; scontrol show job $j | grep -i "State\|RunTime\|TimeLimit"; 
done
```

### Expected Outcome
- Faster start (normal QoS priority vs. standby backfill)
- Results aggregated in `e1_results.csv` once complete
- Per-run artifacts in `/depot/sbagchi/data/josh/RL/FindAndDefeatZerglings/results_split_advanced/`

### Next Steps
1. Monitor jobs for start and completion
2. Verify results in CSV and per-run directories
3. Analyze variance if results show similar spread (0–80%) as smoke runs
4. Decide on Stage E2 or parameter adjustment based on E1 convergence

### Related
- [[2025-10-19 Stage E1 chained 1k eps seeds 4 6 8]] (canceled)
- [[2025-10-19 Stage E1 smoke runs seeds 6 and 8]]
- [[2025-10-19 Stage E1 smoke run 300eps seed4]]

---

## Stage E1 — 2h standby chunks (800 eps per seed)

### Summary
Completed 2-hour standby runs at 32×32 for seeds 4, 6, and 8. Each run reached ~800 episodes and produced test evaluations over 5 episodes.

### Results
- Seed 4 — Run [[20251021_164433_E1_seed4]]: win_rate 20.0%, avg_reward 1.0
- Seed 6 — Run [[20251021_164432_E1_seed6]]: win_rate 40.0%, avg_reward 0.4
- Seed 8 — Run [[20251021_164435_E1_seed8]]: win_rate 20.0%, avg_reward 0.2

Artifacts (local): `01 Projects/ARL RL/Experiment-Results/10-21-2025/`

### Configuration (per job)
- Episodes: 800
- Resolution: 32×32
- LR=5e-5, EPS_DECAY=100k, TUF=300, Batch=4, StepMul=16
- Test episodes: 5

### Notes
- Variance persists across seeds but appears to moderate relative to 300-episode smoke runs.
- Proceed by adding another short chunk per seed to reach 1k+ episodes for more reliable comparison.

### Next
1) Submit additional short chunks (200–400 eps) per seed to reach ≥1000 episodes.  
2) Aggregate in `e1_results.csv` and update Experiments with final 1k-episode outcomes.  
3) Decide E2 (Dueling) vs. E1 tuning based on cross-seed mean/variance at ≥1k eps.
